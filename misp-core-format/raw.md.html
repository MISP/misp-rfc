<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>MISP core format</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Conventions and Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Format">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Overview">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Event">
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 Event Attributes">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Objects">
<link href="#rfc.section.2.3.1" rel="Chapter" title="2.3.1 Org">
<link href="#rfc.section.2.3.2" rel="Chapter" title="2.3.2 Orgc">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Attribute">
<link href="#rfc.section.2.4.1" rel="Chapter" title="2.4.1 Sample Attribute Object">
<link href="#rfc.section.2.4.2" rel="Chapter" title="2.4.2 Attribute Attributes">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 ShadowAttribute">
<link href="#rfc.section.2.5.1" rel="Chapter" title="2.5.1 Sample Attribute Object">
<link href="#rfc.section.2.5.2" rel="Chapter" title="2.5.2 ShadowAttribute Attributes">
<link href="#rfc.section.2.5.3" rel="Chapter" title="2.5.3 Org">
<link href="#rfc.section.2.6" rel="Chapter" title="2.6 Object">
<link href="#rfc.section.2.6.1" rel="Chapter" title="2.6.1 Sample Object">
<link href="#rfc.section.2.6.2" rel="Chapter" title="2.6.2 Object Attributes">
<link href="#rfc.section.2.7" rel="Chapter" title="2.7 Object References">
<link href="#rfc.section.2.7.1" rel="Chapter" title="2.7.1 Sample ObjectReference object">
<link href="#rfc.section.2.7.2" rel="Chapter" title="2.7.2 ObjectReference Attributes">
<link href="#rfc.section.2.8" rel="Chapter" title="2.8 Tag">
<link href="#rfc.section.2.8.1" rel="Chapter" title="2.8.1 Sample Tag">
<link href="#rfc.section.2.9" rel="Chapter" title="2.9 Sighting">
<link href="#rfc.section.2.9.1" rel="Chapter" title="2.9.1 Sample Sighting">
<link href="#rfc.section.2.10" rel="Chapter" title="2.10 Galaxy">
<link href="#rfc.section.2.10.1" rel="Chapter" title="2.10.1 Sample Galaxy">
<link href="#rfc.section.3" rel="Chapter" title="3 JSON Schema">
<link href="#rfc.section.4" rel="Chapter" title="4 Manifest">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Format">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Sample Manifest">
<link href="#rfc.section.5" rel="Chapter" title="5 Implementation">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements">
<link href="#rfc.section.8" rel="Chapter" title="8 References">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.23.1 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Dulaunoy, A. and A. Iklody" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-dulaunoy-misp-core-format" />
  <meta name="dct.issued" scheme="ISO8601" content="2020-05-26" />
  <meta name="dct.abstract" content="This document describes the MISP core format used to exchange indicators and threat information between MISP (Open Source Threat Intelligence Sharing Platform formerly known as Malware Information Sharing Platform) instances.  The JSON format includes the overall structure along with the semantic associated for each respective key. The format is described to support other implementations which reuse the format and ensuring an interoperability with existing MISP  software and other Threat Intelligence Platforms.  " />
  <meta name="description" content="This document describes the MISP core format used to exchange indicators and threat information between MISP (Open Source Threat Intelligence Sharing Platform formerly known as Malware Information Sharing Platform) instances.  The JSON format includes the overall structure along with the semantic associated for each respective key. The format is described to support other implementations which reuse the format and ensuring an interoperability with existing MISP  software and other Threat Intelligence Platforms.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">A. Dulaunoy</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">A. Iklody</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">CIRCL</td>
</tr>
<tr>
<td class="left">Expires: November 27, 2020</td>
<td class="right">May 26, 2020</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">MISP core format<br />
  <span class="filename">draft-dulaunoy-misp-core-format</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes the MISP core format used to exchange indicators and threat information between MISP (Open Source Threat Intelligence Sharing Platform formerly known as Malware Information Sharing Platform) instances.  The JSON format includes the overall structure along with the semantic associated for each respective key. The format is described to support other implementations which reuse the format and ensuring an interoperability with existing MISP <a href="#MISP-P" class="xref">[MISP-P]</a> software and other Threat Intelligence Platforms.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on November 27, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2020 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Conventions and Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Format</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Overview</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Event</a>
</li>
<ul><li>2.2.1.   <a href="#rfc.section.2.2.1">Event Attributes</a>
</li>
</ul><li>2.3.   <a href="#rfc.section.2.3">Objects</a>
</li>
<ul><li>2.3.1.   <a href="#rfc.section.2.3.1">Org</a>
</li>
<li>2.3.2.   <a href="#rfc.section.2.3.2">Orgc</a>
</li>
</ul><li>2.4.   <a href="#rfc.section.2.4">Attribute</a>
</li>
<ul><li>2.4.1.   <a href="#rfc.section.2.4.1">Sample Attribute Object</a>
</li>
<li>2.4.2.   <a href="#rfc.section.2.4.2">Attribute Attributes</a>
</li>
</ul><li>2.5.   <a href="#rfc.section.2.5">ShadowAttribute</a>
</li>
<ul><li>2.5.1.   <a href="#rfc.section.2.5.1">Sample Attribute Object</a>
</li>
<li>2.5.2.   <a href="#rfc.section.2.5.2">ShadowAttribute Attributes</a>
</li>
<li>2.5.3.   <a href="#rfc.section.2.5.3">Org</a>
</li>
</ul><li>2.6.   <a href="#rfc.section.2.6">Object</a>
</li>
<ul><li>2.6.1.   <a href="#rfc.section.2.6.1">Sample Object</a>
</li>
<li>2.6.2.   <a href="#rfc.section.2.6.2">Object Attributes</a>
</li>
</ul><li>2.7.   <a href="#rfc.section.2.7">Object References</a>
</li>
<ul><li>2.7.1.   <a href="#rfc.section.2.7.1">Sample ObjectReference object</a>
</li>
<li>2.7.2.   <a href="#rfc.section.2.7.2">ObjectReference Attributes</a>
</li>
</ul><li>2.8.   <a href="#rfc.section.2.8">Tag</a>
</li>
<ul><li>2.8.1.   <a href="#rfc.section.2.8.1">Sample Tag</a>
</li>
</ul><li>2.9.   <a href="#rfc.section.2.9">Sighting</a>
</li>
<ul><li>2.9.1.   <a href="#rfc.section.2.9.1">Sample Sighting</a>
</li>
</ul><li>2.10.   <a href="#rfc.section.2.10">Galaxy</a>
</li>
<ul><li>2.10.1.   <a href="#rfc.section.2.10.1">Sample Galaxy</a>
</li>
</ul></ul><li>3.   <a href="#rfc.section.3">JSON Schema</a>
</li>
<li>4.   <a href="#rfc.section.4">Manifest</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Format</a>
</li>
<ul><li>4.1.1.   <a href="#rfc.section.4.1.1">Sample Manifest</a>
</li>
</ul></ul><li>5.   <a href="#rfc.section.5">Implementation</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgements</a>
</li>
<li>8.   <a href="#rfc.section.8">References</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<ul><li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Sharing threat information became a fundamental requirements in the Internet, security and intelligence community at large. Threat information can include indicators of compromise, malicious file indicators, financial fraud indicators or even detailed information about a threat actor. MISP <a href="#MISP-P" class="xref">[MISP-P]</a> started as an open source project in late 2011 and the MISP format started to be widely used as an exchange format within the community in the past years. The aim of this document is to describe the specification and the MISP core format.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#conventions-and-terminology" id="conventions-and-terminology">Conventions and Terminology</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 <a href="#RFC2119" class="xref">[RFC2119]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#format" id="format">Format</a>
</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#overview" id="overview">Overview</a>
</h1>
<p id="rfc.section.2.1.p.1">The MISP core format is in the JSON <a href="#RFC8259" class="xref">[RFC8259]</a> format. In MISP, an event is composed of a single JSON object.  </p>
<p id="rfc.section.2.1.p.2">A capitalized key (like Event, Org) represent a data model and a non-capitalised key is just an attribute. This nomenclature can support an implementation to represent the MISP format in another data structure.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#event" id="event">Event</a>
</h1>
<p id="rfc.section.2.2.p.1">An event is a simple meta structure scheme where attributes and meta-data are embedded to compose a coherent set of indicators. An event can be composed from an incident, a security analysis report or a specific threat actor analysis. The meaning of an event only depends of the information embedded in the event.  </p>
<h1 id="rfc.section.2.2.1">
<a href="#rfc.section.2.2.1">2.2.1.</a> <a href="#event-attributes" id="event-attributes">Event Attributes</a>
</h1>
<h1 id="rfc.section.2.2.1.1">
<a href="#rfc.section.2.2.1.1">2.2.1.1.</a> <a href="#uuid" id="uuid">uuid</a>
</h1>
<p id="rfc.section.2.2.1.1.p.1">uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the event. The uuid MUST be preserved for any updates or transfer of the same event. UUID version 4 is RECOMMENDED when assigning it to a new event.  </p>
<p id="rfc.section.2.2.1.1.p.2">uuid is represented as a JSON string. uuid MUST be present.  </p>
<h1 id="rfc.section.2.2.1.2">
<a href="#rfc.section.2.2.1.2">2.2.1.2.</a> <a href="#id" id="id">id</a>
</h1>
<p id="rfc.section.2.2.1.2.p.1">id represents the human-readable identifier associated to the event for a specific MISP instance.  A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.2.1.2.p.2">id is represented as a JSON string. id SHALL be present.  </p>
<h1 id="rfc.section.2.2.1.3">
<a href="#rfc.section.2.2.1.3">2.2.1.3.</a> <a href="#published" id="published">published</a>
</h1>
<p id="rfc.section.2.2.1.3.p.1">published represents the event publication state. If the event was published, the published value MUST be true.  In any other publication state, the published value MUST be false.  </p>
<p id="rfc.section.2.2.1.3.p.2">published is represented as a JSON boolean. published MUST be present.  </p>
<h1 id="rfc.section.2.2.1.4">
<a href="#rfc.section.2.2.1.4">2.2.1.4.</a> <a href="#info" id="info">info</a>
</h1>
<p id="rfc.section.2.2.1.4.p.1">info represents the information field of the event. info is a free-text value to provide a human-readable summary of the event. info SHOULD NOT be bigger than 256 characters and SHOULD NOT include new-lines.  </p>
<p id="rfc.section.2.2.1.4.p.2">info is represented as a JSON string. info MUST be present.  </p>
<h1 id="rfc.section.2.2.1.5">
<a href="#rfc.section.2.2.1.5">2.2.1.5.</a> <a href="#threatlevelid" id="threatlevelid">threat_level_id</a>
</h1>
<p id="rfc.section.2.2.1.5.p.1">threat_level_id represents the threat level.  </p>
<p></p>

<dl>
<dt>4:</dt>
<dd style="margin-left: 8">
<br> Undefined</dd>
<dt>3:</dt>
<dd style="margin-left: 8">
<br> Low</dd>
<dt>2:</dt>
<dd style="margin-left: 8">
<br> Medium</dd>
<dt>1:</dt>
<dd style="margin-left: 8">
<br> High</dd>
</dl>

<p> </p>
<p id="rfc.section.2.2.1.5.p.3">If a higher granularity is required, a MISP taxonomy applied as a Tag SHOULD be preferred.  </p>
<p id="rfc.section.2.2.1.5.p.4">threat_level_id is represented as a JSON string. threat_level_id SHALL be present.  </p>
<h1 id="rfc.section.2.2.1.6">
<a href="#rfc.section.2.2.1.6">2.2.1.6.</a> <a href="#analysis" id="analysis">analysis</a>
</h1>
<p id="rfc.section.2.2.1.6.p.1">analysis represents the analysis level.  </p>
<p></p>

<dl>
<dt>0:</dt>
<dd style="margin-left: 8">
<br> Initial</dd>
<dt>1:</dt>
<dd style="margin-left: 8">
<br> Ongoing</dd>
<dt>2:</dt>
<dd style="margin-left: 8">
<br> Complete</dd>
</dl>

<p> </p>
<p id="rfc.section.2.2.1.6.p.3">If a higher granularity is required, a MISP taxonomy applied as a Tag SHOULD be preferred.  </p>
<p id="rfc.section.2.2.1.6.p.4">analysis is represented as a JSON string. analysis SHALL be present.  </p>
<h1 id="rfc.section.2.2.1.7">
<a href="#rfc.section.2.2.1.7">2.2.1.7.</a> <a href="#date" id="date">date</a>
</h1>
<p id="rfc.section.2.2.1.7.p.1">date represents a reference date to the event in ISO 8601 format (date only: YYYY-MM-DD). This date corresponds to the date the event occurred, which may be in the past.  </p>
<p id="rfc.section.2.2.1.7.p.2">date is represented as a JSON string. date MUST be present.  </p>
<h1 id="rfc.section.2.2.1.8">
<a href="#rfc.section.2.2.1.8">2.2.1.8.</a> <a href="#timestamp" id="timestamp">timestamp</a>
</h1>
<p id="rfc.section.2.2.1.8.p.1">timestamp represents a reference time when the event, or one of the attributes within the event was created, or last updated/edited on the instance. timestamp is expressed in seconds (decimal) since 1st of January 1970 (Unix timestamp). The time zone MUST be UTC.  </p>
<p id="rfc.section.2.2.1.8.p.2">timestamp is represented as a JSON string. timestamp MUST be present.  </p>
<h1 id="rfc.section.2.2.1.9">
<a href="#rfc.section.2.2.1.9">2.2.1.9.</a> <a href="#publishtimestamp" id="publishtimestamp">publish_timestamp</a>
</h1>
<p id="rfc.section.2.2.1.9.p.1">publish_timestamp represents a reference time when the event was published on the instance. published_timestamp is expressed in seconds (decimal) since 1st of January 1970 (Unix timestamp). At each publication of an event, publish_timestamp MUST be updated. The time zone MUST be UTC. If the published_timestamp is present and the published flag is set to false, the publish_timestamp represents the previous publication timestamp. If the event was never published, the published_timestamp MUST be set to 0.  </p>
<p id="rfc.section.2.2.1.9.p.2">publish_timestamp is represented as a JSON string. publish_timestamp MUST be present.  </p>
<h1 id="rfc.section.2.2.1.10">
<a href="#rfc.section.2.2.1.10">2.2.1.10.</a> <a href="#orgid" id="orgid">org_id</a>
</h1>
<p id="rfc.section.2.2.1.10.p.1">org_id represents a human-readable identifier referencing an Org object of the organisation which generated the event. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.2.1.10.p.2">The org_id MUST be updated when the event is generated by a new instance.  </p>
<p id="rfc.section.2.2.1.10.p.3">org_id is represented as a JSON string. org_id MUST be present.  </p>
<h1 id="rfc.section.2.2.1.11">
<a href="#rfc.section.2.2.1.11">2.2.1.11.</a> <a href="#orgcid" id="orgcid">orgc_id</a>
</h1>
<p id="rfc.section.2.2.1.11.p.1">orgc_id represents a human-readable identifier referencing an Orgc object of the organisation which created the event.  </p>
<p id="rfc.section.2.2.1.11.p.2">The orgc_id and Org object MUST be preserved for any updates or transfer of the same event.  </p>
<p id="rfc.section.2.2.1.11.p.3">orgc_id is represented as a JSON string. orgc_id MUST be present.  </p>
<h1 id="rfc.section.2.2.1.12">
<a href="#rfc.section.2.2.1.12">2.2.1.12.</a> <a href="#attributecount" id="attributecount">attribute_count</a>
</h1>
<p id="rfc.section.2.2.1.12.p.1">attribute_count represents the number of attributes in the event. attribute_count is expressed in decimal.  </p>
<p id="rfc.section.2.2.1.12.p.2">attribute_count is represented as a JSON string. attribute_count SHALL be present.  </p>
<h1 id="rfc.section.2.2.1.13">
<a href="#rfc.section.2.2.1.13">2.2.1.13.</a> <a href="#distribution" id="distribution">distribution</a>
</h1>
<p id="rfc.section.2.2.1.13.p.1">distribution represents the basic distribution rules of the event. The system must adhere to the distribution setting for access control and for dissemination of the event.  </p>
<p id="rfc.section.2.2.1.13.p.2">distribution is represented by a JSON string. distribution MUST be present and be one of the following options: </p>
<p></p>

<dl>
<dt>0</dt>
<dd style="margin-left: 8">
<br> Your Organisation Only</dd>
<dt>1</dt>
<dd style="margin-left: 8">
<br> This Community Only</dd>
<dt>2</dt>
<dd style="margin-left: 8">
<br> Connected Communities</dd>
<dt>3</dt>
<dd style="margin-left: 8">
<br> All Communities</dd>
<dt>4</dt>
<dd style="margin-left: 8">
<br> Sharing Group</dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.2.1.14">
<a href="#rfc.section.2.2.1.14">2.2.1.14.</a> <a href="#sharinggroupid" id="sharinggroupid">sharing_group_id</a>
</h1>
<p id="rfc.section.2.2.1.14.p.1">sharing_group_id represents a human-readable identifier referencing a Sharing Group object that defines the distribution of the event, if distribution level "4" is set. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.2.1.14.p.2">sharing_group_id is represented by a JSON string and SHOULD be present. If a distribution level other than "4" is chosen the sharing_group_id MUST be set to "0".  </p>
<h1 id="rfc.section.2.2.1.15">
<a href="#rfc.section.2.2.1.15">2.2.1.15.</a> <a href="#extendsuuid" id="extendsuuid">extends_uuid</a>
</h1>
<p id="rfc.section.2.2.1.15.p.1">extends_uuid represents which event is extended by this event. The extends_uuid is described as a Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> with the UUID of the extended event.  </p>
<p id="rfc.section.2.2.1.15.p.2">extends_uuid is represented as a JSON string. extends_uuid SHOULD be present.  </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#objects" id="objects">Objects</a>
</h1>
<h1 id="rfc.section.2.3.1">
<a href="#rfc.section.2.3.1">2.3.1.</a> <a href="#org" id="org">Org</a>
</h1>
<p id="rfc.section.2.3.1.p.1">An Org object is composed of an uuid, name and id.  </p>
<p id="rfc.section.2.3.1.p.2">The uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the organisation.  The organisation UUID is globally assigned to an organisation and SHALL be kept overtime.  </p>
<p id="rfc.section.2.3.1.p.3">The name is a readable description of the organisation and SHOULD be present.  The id is a human-readable identifier generated by the instance and used as reference in the event.  A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.3.1.p.4">uuid, name and id are represented as a JSON string. uuid, name and id MUST be present.  </p>
<h1 id="rfc.section.2.3.1.1">
<a href="#rfc.section.2.3.1.1">2.3.1.1.</a> <a href="#sample-org-object" id="sample-org-object">Sample Org Object</a>
</h1>
<pre>
"Org": {
        "id": "2",
        "name": "CIRCL",
        "uuid": "55f6ea5e-2c60-40e5-964f-47a8950d210f"
       }
</pre>
<h1 id="rfc.section.2.3.2">
<a href="#rfc.section.2.3.2">2.3.2.</a> <a href="#orgc" id="orgc">Orgc</a>
</h1>
<p id="rfc.section.2.3.2.p.1">An Orgc object is composed of an uuid, name and id.  </p>
<p id="rfc.section.2.3.2.p.2">The uuid MUST be preserved for any updates or transfer of the same event. UUID version 4 is RECOMMENDED when assigning it to a new event.  The organisation UUID is globally assigned to an organisation and SHALL be kept overtime.  </p>
<p id="rfc.section.2.3.2.p.3">The name is a readable description of the organisation and SHOULD be present.  The id is a human-readable identifier generated by the instance and used as reference in the event.  A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.3.2.p.4">uuid, name and id are represented as a JSON string. uuid, name and id MUST be present.  </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> <a href="#attribute" id="attribute">Attribute</a>
</h1>
<p id="rfc.section.2.4.p.1">Attributes are used to describe the indicators and contextual data of an event. The main information contained in an attribute is made up of a category-type-value triplet, where the category and type give meaning and context to the value. Through the various category-type combinations a wide range of information can be conveyed.  </p>
<p id="rfc.section.2.4.p.2">A MISP document MUST at least includes category-type-value triplet described in section "Attribute Attributes".  </p>
<h1 id="rfc.section.2.4.1">
<a href="#rfc.section.2.4.1">2.4.1.</a> <a href="#sample-attribute-object" id="sample-attribute-object">Sample Attribute Object</a>
</h1>
<pre>
"Attribute": {
              "id": "346056",
              "type": "comment",
              "category": "Other",
              "to_ids": false,
              "uuid": "57f4f6d9-cd20-458b-84fd-109ec0a83869",
              "event_id": "3357",
              "distribution": "5",
              "timestamp": "1475679332",
              "comment": "",
              "sharing_group_id": "0",
              "deleted": false,
              "value": "Hello world",
              "SharingGroup": [],
              "ShadowAttribute": [],
              "RelatedAttribute": [],
              "first_seen": "2019-06-02T22:14:28.711954+00:00",
              "last_seen": null
             }
</pre>
<h1 id="rfc.section.2.4.2">
<a href="#rfc.section.2.4.2">2.4.2.</a> <a href="#attribute-attributes" id="attribute-attributes">Attribute Attributes</a>
</h1>
<h1 id="rfc.section.2.4.2.1">
<a href="#rfc.section.2.4.2.1">2.4.2.1.</a> <a href="#uuid-1" id="uuid-1">uuid</a>
</h1>
<p id="rfc.section.2.4.2.1.p.1">uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the event. The uuid MUST be preserved for any updates or transfer of the same event. UUID version 4 is RECOMMENDED when assigning it to a new event.  </p>
<p id="rfc.section.2.4.2.1.p.2">uuid is represented as a JSON string. uuid MUST be present.  </p>
<h1 id="rfc.section.2.4.2.2">
<a href="#rfc.section.2.4.2.2">2.4.2.2.</a> <a href="#id-1" id="id-1">id</a>
</h1>
<p id="rfc.section.2.4.2.2.p.1">id represents the human-readable identifier associated to the event for a specific MISP instance. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.4.2.2.p.2">id is represented as a JSON string. id SHALL be present.  </p>
<h1 id="rfc.section.2.4.2.3">
<a href="#rfc.section.2.4.2.3">2.4.2.3.</a> <a href="#type" id="type">type</a>
</h1>
<p id="rfc.section.2.4.2.3.p.1">type represents the means through which an attribute tries to describe the intent of the attribute creator, using a list of pre-defined attribute types.  </p>
<p id="rfc.section.2.4.2.3.p.2">type is represented as a JSON string. type MUST be present and it MUST be a valid selection for the chosen category. The list of valid category-type combinations is as follows: </p>
<p></p>

<dl>
<dt>Antivirus detection</dt>
<dd style="margin-left: 8">
<br> link, comment, text, hex, attachment, other, anonymised</dd>
<dt>Artifacts dropped</dt>
<dd style="margin-left: 8">
<br> md5, sha1, sha224, sha256, sha384, sha512, sha512/224, sha512/256, sha3-224, sha3-256, sha3-384, sha3-512, ssdeep, imphash, impfuzzy, authentihash, vhash, cdhash, filename, filename|md5, filename|sha1, filename|sha224, filename|sha256, filename|sha384, filename|sha512, filename|sha512/224, filename|sha512/256, filename|sha3-224, filename|sha3-256, filename|sha3-384, filename|sha3-512, filename|authentihash, filename|vhash, filename|ssdeep, filename|tlsh, filename|imphash, filename|impfuzzy, filename|pehash, regkey, regkey|value, pattern-in-file, pattern-in-memory, pdb, stix2-pattern, yara, sigma, attachment, malware-sample, named pipe, mutex, windows-scheduled-task, windows-service-name, windows-service-displayname, comment, text, hex, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, other, cookie, gene, kusto-query, mime-type, anonymised</dd>
<dt>Attribution</dt>
<dd style="margin-left: 8">
<br> threat-actor, campaign-name, campaign-id, whois-registrant-phone, whois-registrant-email, whois-registrant-name, whois-registrant-org, whois-registrar, whois-creation-date, comment, text, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, other, dns-soa-email, anonymised</dd>
<dt>External analysis</dt>
<dd style="margin-left: 8">
<br> md5, sha1, sha256, sha3-224, sha3-256, sha3-384, sha3-512, filename, filename|md5, filename|sha1, filename|sha256, filename|sha3-224, filename|sha3-256, filename|sha3-384, filename|sha3-512, ip-src, ip-dst, ip-dst|port, ip-src|port, mac-address, mac-eui-64, hostname, domain, domain|ip, url, user-agent, regkey, regkey|value, AS, snort, bro, zeek, pattern-in-file, pattern-in-traffic, pattern-in-memory, vulnerability, weakness, attachment, malware-sample, link, comment, text, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, ja3-fingerprint-md5, hassh-md5, hasshserver-md5, github-repository, other, cortex, anonymised, community-id</dd>
<dt>Financial fraud</dt>
<dd style="margin-left: 8">
<br> btc, dash, xmr, iban, bic, bank-account-nr, aba-rtn, bin, cc-number, prtn, phone-number, comment, text, other, hex, anonymised</dd>
<dt>Internal reference</dt>
<dd style="margin-left: 8">
<br> text, link, comment, other, hex, anonymised, git-commit-id</dd>
<dt>Network activity</dt>
<dd style="margin-left: 8">
<br> ip-src, ip-dst, ip-dst|port, ip-src|port, port, hostname, domain, domain|ip, mac-address, mac-eui-64, email-dst, email-src, eppn, url, uri, user-agent, http-method, AS, snort, pattern-in-file, stix2-pattern, pattern-in-traffic, attachment, comment, text, x509-fingerprint-md5, x509-fingerprint-sha1, x509-fingerprint-sha256, ja3-fingerprint-md5, hassh-md5, hasshserver-md5, other, hex, cookie, hostname|port, bro, zeek, anonymised, community-id, email-subject</dd>
<dt>Other</dt>
<dd style="margin-left: 8">
<br> comment, text, other, size-in-bytes, counter, datetime, cpe, port, float, hex, phone-number, boolean, anonymised</dd>
<dt>Payload delivery</dt>
<dd style="margin-left: 8">
<br> md5, sha1, sha224, sha256, sha384, sha512, sha512/224, sha512/256, sha3-224, sha3-256, sha3-384, sha3-512, ssdeep, imphash, impfuzzy, authentihash, vhash, pehash, tlsh, cdhash, filename, filename|md5, filename|sha1, filename|sha224, filename|sha256, filename|sha384, filename|sha512, filename|sha512/224, filename|sha512/256, filename|sha3-224, filename|sha3-256, filename|sha3-384, filename|sha3-512, filename|authentihash, filename|vhash, filename|ssdeep, filename|tlsh, filename|imphash, filename|impfuzzy, filename|pehash, mac-address, mac-eui-64, ip-src, ip-dst, ip-dst|port, ip-src|port, hostname, domain, email-src, email-dst, email-subject, email-attachment, email-body, url, user-agent, AS, pattern-in-file, pattern-in-traffic, stix2-pattern, yara, sigma, mime-type, attachment, malware-sample, link, malware-type, comment, text, hex, vulnerability, weakness, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, ja3-fingerprint-md5, hassh-md5, hasshserver-md5, other, hostname|port, email-dst-display-name, email-src-display-name, email-header, email-reply-to, email-x-mailer, email-mime-boundary, email-thread-index, email-message-id, mobile-application-id, chrome-extension-id, whois-registrant-email, anonymised</dd>
<dt>Payload installation</dt>
<dd style="margin-left: 8">
<br> md5, sha1, sha224, sha256, sha384, sha512, sha512/224, sha512/256, sha3-224, sha3-256, sha3-384, sha3-512, ssdeep, imphash, impfuzzy, authentihash, vhash, pehash, tlsh, cdhash, filename, filename|md5, filename|sha1, filename|sha224, filename|sha256, filename|sha384, filename|sha512, filename|sha512/224, filename|sha512/256, filename|sha3-224, filename|sha3-256, filename|sha3-384, filename|sha3-512, filename|authentihash, filename|vhash, filename|ssdeep, filename|tlsh, filename|imphash, filename|impfuzzy, filename|pehash, pattern-in-file, pattern-in-traffic, pattern-in-memory, stix2-pattern, yara, sigma, vulnerability, weakness, attachment, malware-sample, malware-type, comment, text, hex, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, mobile-application-id, chrome-extension-id, other, mime-type, anonymised</dd>
<dt>Payload type</dt>
<dd style="margin-left: 8">
<br> comment, text, other, anonymised</dd>
<dt>Persistence mechanism</dt>
<dd style="margin-left: 8">
<br> filename, regkey, regkey|value, comment, text, other, hex, anonymised</dd>
<dt>Person</dt>
<dd style="margin-left: 8">
<br> first-name, middle-name, last-name, date-of-birth, place-of-birth, gender, passport-number, passport-country, passport-expiration, redress-number, nationality, visa-number, issue-date-of-the-visa, primary-residence, country-of-residence, special-service-request, frequent-flyer-number, travel-details, payment-details, place-port-of-original-embarkation, place-port-of-clearance, place-port-of-onward-foreign-destination, passenger-name-record-locator-number, comment, text, other, phone-number, identity-card-number, anonymised</dd>
<dt>Social network</dt>
<dd style="margin-left: 8">
<br> github-username, github-repository, github-organisation, jabber-id, twitter-id, email-src, email-dst, eppn, comment, text, other, whois-registrant-email, anonymised</dd>
<dt>Support Tool</dt>
<dd style="margin-left: 8">
<br> link, text, attachment, comment, other, hex, anonymised</dd>
<dt>Targeting data</dt>
<dd style="margin-left: 8">
<br> target-user, target-email, target-machine, target-org, target-location, target-external, comment, anonymised</dd>
</dl>

<p> </p>
<p id="rfc.section.2.4.2.3.p.4">Attributes are based on the usage within their different communities. Attributes can be extended on a regular basis and this reference document is updated accordingly.  </p>
<h1 id="rfc.section.2.4.2.4">
<a href="#rfc.section.2.4.2.4">2.4.2.4.</a> <a href="#category" id="category">category</a>
</h1>
<p id="rfc.section.2.4.2.4.p.1">category represents the intent of what the attribute is describing as selected by the attribute creator, using a list of pre-defined attribute categories.  </p>
<p id="rfc.section.2.4.2.4.p.2">category is represented as a JSON string. category MUST be present and it MUST be a valid selection for the chosen type. The list of valid category-type combinations is mentioned above.  </p>
<h1 id="rfc.section.2.4.2.5">
<a href="#rfc.section.2.4.2.5">2.4.2.5.</a> <a href="#toids" id="toids">to_ids</a>
</h1>
<p id="rfc.section.2.4.2.5.p.1">to_ids represents whether the attribute is meant to be actionable. Actionable defined attributes that can be used in automated processes as a pattern for detection in Local or Network Intrusion Detection System, log analysis tools or even filtering mechanisms.  </p>
<p id="rfc.section.2.4.2.5.p.2">to_ids is represented as a JSON boolean. to_ids MUST be present.  </p>
<h1 id="rfc.section.2.4.2.6">
<a href="#rfc.section.2.4.2.6">2.4.2.6.</a> <a href="#eventid" id="eventid">event_id</a>
</h1>
<p id="rfc.section.2.4.2.6.p.1">event_id represents a human-readable identifier referencing the Event object that the attribute belongs to. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.4.2.6.p.2">The event_id SHOULD be updated when the event is imported to reflect the newly created event's id on the instance.  </p>
<p id="rfc.section.2.4.2.6.p.3">event_id is represented as a JSON string. event_id MUST be present.  </p>
<h1 id="rfc.section.2.4.2.7">
<a href="#rfc.section.2.4.2.7">2.4.2.7.</a> <a href="#distribution-1" id="distribution-1">distribution</a>
</h1>
<p id="rfc.section.2.4.2.7.p.1">distribution represents the basic distribution rules of the attribute. The system must adhere to the distribution setting for access control and for dissemination of the attribute.  </p>
<p id="rfc.section.2.4.2.7.p.2">distribution is represented by a JSON string. distribution MUST be present and be one of the following options: </p>
<p></p>

<dl>
<dt>0</dt>
<dd style="margin-left: 8">
<br> Your Organisation Only</dd>
<dt>1</dt>
<dd style="margin-left: 8">
<br> This Community Only</dd>
<dt>2</dt>
<dd style="margin-left: 8">
<br> Connected Communities</dd>
<dt>3</dt>
<dd style="margin-left: 8">
<br> All Communities</dd>
<dt>4</dt>
<dd style="margin-left: 8">
<br> Sharing Group</dd>
<dt>5</dt>
<dd style="margin-left: 8">
<br> Inherit Event</dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.4.2.8">
<a href="#rfc.section.2.4.2.8">2.4.2.8.</a> <a href="#timestamp-1" id="timestamp-1">timestamp</a>
</h1>
<p id="rfc.section.2.4.2.8.p.1">timestamp represents a reference time when the attribute was created or last modified. timestamp is expressed in seconds (decimal) since 1st of January 1970 (Unix timestamp). The time zone MUST be UTC.  </p>
<p id="rfc.section.2.4.2.8.p.2">timestamp is represented as a JSON string. timestamp MUST be present.  </p>
<h1 id="rfc.section.2.4.2.9">
<a href="#rfc.section.2.4.2.9">2.4.2.9.</a> <a href="#comment" id="comment">comment</a>
</h1>
<p id="rfc.section.2.4.2.9.p.1">comment is a contextual comment field.  </p>
<p id="rfc.section.2.4.2.9.p.2">comment is represented by a JSON string. comment MAY be present.  </p>
<h1 id="rfc.section.2.4.2.10">
<a href="#rfc.section.2.4.2.10">2.4.2.10.</a> <a href="#sharinggroupid-1" id="sharinggroupid-1">sharing_group_id</a>
</h1>
<p id="rfc.section.2.4.2.10.p.1">sharing_group_id represents a human-readable identifier referencing a Sharing Group object that defines the distribution of the attribute, if distribution level "4" is set. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.4.2.10.p.2">sharing_group_id is represented by a JSON string and SHOULD be present. If a distribution level other than "4" is chosen the sharing_group_id MUST be set to "0".  </p>
<h1 id="rfc.section.2.4.2.11">
<a href="#rfc.section.2.4.2.11">2.4.2.11.</a> <a href="#deleted" id="deleted">deleted</a>
</h1>
<p id="rfc.section.2.4.2.11.p.1">deleted represents a setting that allows attributes to be revoked. Revoked attributes are not actionable and exist merely to inform other instances of a revocation.  </p>
<p id="rfc.section.2.4.2.11.p.2">deleted is represented by a JSON boolean. deleted MUST be present.  </p>
<h1 id="rfc.section.2.4.2.12">
<a href="#rfc.section.2.4.2.12">2.4.2.12.</a> <a href="#data" id="data">data</a>
</h1>
<p id="rfc.section.2.4.2.12.p.1">data contains the base64 encoded contents of an attachment or a malware sample. For malware samples, the sample MUST be encrypted using a password protected zip archive, with the password being "infected".  </p>
<p id="rfc.section.2.4.2.12.p.2">data is represented by a JSON string in base64 encoding. data MUST be set for attributes of type malware-sample and attachment.  </p>
<h1 id="rfc.section.2.4.2.13">
<a href="#rfc.section.2.4.2.13">2.4.2.13.</a> <a href="#relatedattribute" id="relatedattribute">RelatedAttribute</a>
</h1>
<p id="rfc.section.2.4.2.13.p.1">RelatedAttribute is an array of attributes correlating with the current attribute. Each element in the array represents an JSON object which contains an Attribute dictionnary with the external attributes who correlate. Each Attribute MUST include the id, org_id, info and a value. Only the correlations found on the local instance are shown in RelatedAttribute.  </p>
<p id="rfc.section.2.4.2.13.p.2">RelatedAttribute MAY be present.  </p>
<h1 id="rfc.section.2.4.2.14">
<a href="#rfc.section.2.4.2.14">2.4.2.14.</a> <a href="#shadowattribute" id="shadowattribute">ShadowAttribute</a>
</h1>
<p id="rfc.section.2.4.2.14.p.1">ShadowAttribute is an array of shadow attributes that serve as proposals by third parties to alter the containing attribute. The structure of a ShadowAttribute is similar to that of an Attribute, which can be accepted or discarded by the event creator. If accepted, the original attribute containing the shadow attribute is removed and the shadow attribute is converted into an attribute.  </p>
<p id="rfc.section.2.4.2.14.p.2">Each shadow attribute that references an attribute MUST contain the containing attribute's ID in the old_id field and the event's ID in the event_id field.  </p>
<h1 id="rfc.section.2.4.2.15">
<a href="#rfc.section.2.4.2.15">2.4.2.15.</a> <a href="#value" id="value">value</a>
</h1>
<p id="rfc.section.2.4.2.15.p.1">value represents the payload of an attribute. The format of the value is dependent on the type of the attribute.  </p>
<p id="rfc.section.2.4.2.15.p.2">value is represented by a JSON string. value MUST be present.  </p>
<h1 id="rfc.section.2.4.2.16">
<a href="#rfc.section.2.4.2.16">2.4.2.16.</a> <a href="#firstseen" id="firstseen">first_seen</a>
</h1>
<p id="rfc.section.2.4.2.16.p.1">first_seen represents a reference time when the attribute was first seen. first_seen is expressed as an ISO 8601 datetime up to the micro-second with time zone support.  </p>
<p id="rfc.section.2.4.2.16.p.2">first_seen is represented as a JSON string. first_seen MAY be present.  </p>
<h1 id="rfc.section.2.4.2.17">
<a href="#rfc.section.2.4.2.17">2.4.2.17.</a> <a href="#lastseen" id="lastseen">last_seen</a>
</h1>
<p id="rfc.section.2.4.2.17.p.1">last_seen represents a reference time when the attribute was last seen. last_seen is expressed as an ISO 8601 datetime up to the micro-second with time zone support.  </p>
<p id="rfc.section.2.4.2.17.p.2">last_seen is represented as a JSON string. last_seen MAY be present.  </p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> <a href="#shadowattribute-1" id="shadowattribute-1">ShadowAttribute</a>
</h1>
<p id="rfc.section.2.5.p.1">ShadowAttributes are 3rd party created attributes that either propose to add new information to an event or modify existing information. They are not meant to be actionable until the event creator accepts them - at which point they will be converted into attributes or modify an existing attribute.  </p>
<p id="rfc.section.2.5.p.2">They are similar in structure to Attributes but additionally carry a reference to the creator of the ShadowAttribute as well as a revocation flag.  </p>
<h1 id="rfc.section.2.5.1">
<a href="#rfc.section.2.5.1">2.5.1.</a> <a href="#sample-attribute-object-1" id="sample-attribute-object-1">Sample Attribute Object</a>
</h1>
<pre>
"ShadowAttribute":  {
                       "id": "8",
                       "type": "ip-src",
                       "category": "Network activity",
                       "to_ids": false,
                       "uuid": "57d475f1-da78-4569-89de-1458c0a83869",
                       "event_uuid": "57d475e6-41c4-41ca-b450-145ec0a83869",
                       "event_id": "9",
                       "old_id": "319",
                       "comment": "",
                       "org_id": "1",
                       "proposal_to_delete": false,
                       "value": "5.5.5.5",
                       "deleted": false,
                       "Org": {
                           "id": "1",
                           "name": "MISP",
                           "uuid": "568cce5a-0c80-412b-8fdf-1ffac0a83869"
                       },
                       "first_seen": "2019-06-02T22:14:28.711954+00:00",
                       "last_seen": null
                   }
</pre>
<h1 id="rfc.section.2.5.2">
<a href="#rfc.section.2.5.2">2.5.2.</a> <a href="#shadowattribute-attributes" id="shadowattribute-attributes">ShadowAttribute Attributes</a>
</h1>
<h1 id="rfc.section.2.5.2.1">
<a href="#rfc.section.2.5.2.1">2.5.2.1.</a> <a href="#uuid-2" id="uuid-2">uuid</a>
</h1>
<p id="rfc.section.2.5.2.1.p.1">uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the event. The uuid MUST be preserved for any updates or transfer of the same event. UUID version 4 is RECOMMENDED when assigning it to a new event.  </p>
<p id="rfc.section.2.5.2.1.p.2">uuid is represented as a JSON string. uuid MUST be present.  </p>
<h1 id="rfc.section.2.5.2.2">
<a href="#rfc.section.2.5.2.2">2.5.2.2.</a> <a href="#id-2" id="id-2">id</a>
</h1>
<p id="rfc.section.2.5.2.2.p.1">id represents the human-readable identifier associated to the event for a specific MISP instance. human-readable identifier MUST be represented as an unsigned integer.  id is represented as a JSON string. id SHALL be present.  </p>
<h1 id="rfc.section.2.5.2.3">
<a href="#rfc.section.2.5.2.3">2.5.2.3.</a> <a href="#type-1" id="type-1">type</a>
</h1>
<p id="rfc.section.2.5.2.3.p.1">type represents the means through which an attribute tries to describe the intent of the attribute creator, using a list of pre-defined attribute types.  </p>
<p id="rfc.section.2.5.2.3.p.2">type is represented as a JSON string. type MUST be present and it MUST be a valid selection for the chosen category. The list of valid category-type combinations is as follows: </p>
<p></p>

<dl>
<dt>Antivirus detection</dt>
<dd style="margin-left: 8">
<br> link, comment, text, hex, attachment, other, anonymised</dd>
<dt>Artifacts dropped</dt>
<dd style="margin-left: 8">
<br> md5, sha1, sha224, sha256, sha384, sha512, sha512/224, sha512/256, sha3-224, sha3-256, sha3-384, sha3-512, ssdeep, imphash, impfuzzy, authentihash, vhash, cdhash, filename, filename|md5, filename|sha1, filename|sha224, filename|sha256, filename|sha384, filename|sha512, filename|sha512/224, filename|sha512/256, filename|sha3-224, filename|sha3-256, filename|sha3-384, filename|sha3-512, filename|authentihash, filename|vhash, filename|ssdeep, filename|tlsh, filename|imphash, filename|impfuzzy, filename|pehash, regkey, regkey|value, pattern-in-file, pattern-in-memory, pdb, stix2-pattern, yara, sigma, attachment, malware-sample, named pipe, mutex, windows-scheduled-task, windows-service-name, windows-service-displayname, comment, text, hex, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, other, cookie, gene, kusto-query, mime-type, anonymised</dd>
<dt>Attribution</dt>
<dd style="margin-left: 8">
<br> threat-actor, campaign-name, campaign-id, whois-registrant-phone, whois-registrant-email, whois-registrant-name, whois-registrant-org, whois-registrar, whois-creation-date, comment, text, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, other, dns-soa-email, anonymised</dd>
<dt>External analysis</dt>
<dd style="margin-left: 8">
<br> md5, sha1, sha256, sha3-224, sha3-256, sha3-384, sha3-512, filename, filename|md5, filename|sha1, filename|sha256, filename|sha3-224, filename|sha3-256, filename|sha3-384, filename|sha3-512, ip-src, ip-dst, ip-dst|port, ip-src|port, mac-address, mac-eui-64, hostname, domain, domain|ip, url, user-agent, regkey, regkey|value, AS, snort, bro, zeek, pattern-in-file, pattern-in-traffic, pattern-in-memory, vulnerability, weakness, attachment, malware-sample, link, comment, text, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, ja3-fingerprint-md5, hassh-md5, hasshserver-md5, github-repository, other, cortex, anonymised, community-id</dd>
<dt>Financial fraud</dt>
<dd style="margin-left: 8">
<br> btc, dash, xmr, iban, bic, bank-account-nr, aba-rtn, bin, cc-number, prtn, phone-number, comment, text, other, hex, anonymised</dd>
<dt>Internal reference</dt>
<dd style="margin-left: 8">
<br> text, link, comment, other, hex, anonymised, git-commit-id</dd>
<dt>Network activity</dt>
<dd style="margin-left: 8">
<br> ip-src, ip-dst, ip-dst|port, ip-src|port, port, hostname, domain, domain|ip, mac-address, mac-eui-64, email-dst, email-src, eppn, url, uri, user-agent, http-method, AS, snort, pattern-in-file, stix2-pattern, pattern-in-traffic, attachment, comment, text, x509-fingerprint-md5, x509-fingerprint-sha1, x509-fingerprint-sha256, ja3-fingerprint-md5, hassh-md5, hasshserver-md5, other, hex, cookie, hostname|port, bro, zeek, anonymised, community-id, email-subject</dd>
<dt>Other</dt>
<dd style="margin-left: 8">
<br> comment, text, other, size-in-bytes, counter, datetime, cpe, port, float, hex, phone-number, boolean, anonymised</dd>
<dt>Payload delivery</dt>
<dd style="margin-left: 8">
<br> md5, sha1, sha224, sha256, sha384, sha512, sha512/224, sha512/256, sha3-224, sha3-256, sha3-384, sha3-512, ssdeep, imphash, impfuzzy, authentihash, vhash, pehash, tlsh, cdhash, filename, filename|md5, filename|sha1, filename|sha224, filename|sha256, filename|sha384, filename|sha512, filename|sha512/224, filename|sha512/256, filename|sha3-224, filename|sha3-256, filename|sha3-384, filename|sha3-512, filename|authentihash, filename|vhash, filename|ssdeep, filename|tlsh, filename|imphash, filename|impfuzzy, filename|pehash, mac-address, mac-eui-64, ip-src, ip-dst, ip-dst|port, ip-src|port, hostname, domain, email-src, email-dst, email-subject, email-attachment, email-body, url, user-agent, AS, pattern-in-file, pattern-in-traffic, stix2-pattern, yara, sigma, mime-type, attachment, malware-sample, link, malware-type, comment, text, hex, vulnerability, weakness, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, ja3-fingerprint-md5, hassh-md5, hasshserver-md5, other, hostname|port, email-dst-display-name, email-src-display-name, email-header, email-reply-to, email-x-mailer, email-mime-boundary, email-thread-index, email-message-id, mobile-application-id, chrome-extension-id, whois-registrant-email, anonymised</dd>
<dt>Payload installation</dt>
<dd style="margin-left: 8">
<br> md5, sha1, sha224, sha256, sha384, sha512, sha512/224, sha512/256, sha3-224, sha3-256, sha3-384, sha3-512, ssdeep, imphash, impfuzzy, authentihash, vhash, pehash, tlsh, cdhash, filename, filename|md5, filename|sha1, filename|sha224, filename|sha256, filename|sha384, filename|sha512, filename|sha512/224, filename|sha512/256, filename|sha3-224, filename|sha3-256, filename|sha3-384, filename|sha3-512, filename|authentihash, filename|vhash, filename|ssdeep, filename|tlsh, filename|imphash, filename|impfuzzy, filename|pehash, pattern-in-file, pattern-in-traffic, pattern-in-memory, stix2-pattern, yara, sigma, vulnerability, weakness, attachment, malware-sample, malware-type, comment, text, hex, x509-fingerprint-sha1, x509-fingerprint-md5, x509-fingerprint-sha256, mobile-application-id, chrome-extension-id, other, mime-type, anonymised</dd>
<dt>Payload type</dt>
<dd style="margin-left: 8">
<br> comment, text, other, anonymised</dd>
<dt>Persistence mechanism</dt>
<dd style="margin-left: 8">
<br> filename, regkey, regkey|value, comment, text, other, hex, anonymised</dd>
<dt>Person</dt>
<dd style="margin-left: 8">
<br> first-name, middle-name, last-name, date-of-birth, place-of-birth, gender, passport-number, passport-country, passport-expiration, redress-number, nationality, visa-number, issue-date-of-the-visa, primary-residence, country-of-residence, special-service-request, frequent-flyer-number, travel-details, payment-details, place-port-of-original-embarkation, place-port-of-clearance, place-port-of-onward-foreign-destination, passenger-name-record-locator-number, comment, text, other, phone-number, identity-card-number, anonymised</dd>
<dt>Social network</dt>
<dd style="margin-left: 8">
<br> github-username, github-repository, github-organisation, jabber-id, twitter-id, email-src, email-dst, eppn, comment, text, other, whois-registrant-email, anonymised</dd>
<dt>Support Tool</dt>
<dd style="margin-left: 8">
<br> link, text, attachment, comment, other, hex, anonymised</dd>
<dt>Targeting data</dt>
<dd style="margin-left: 8">
<br> target-user, target-email, target-machine, target-org, target-location, target-external, comment, anonymised</dd>
</dl>

<p> </p>
<p id="rfc.section.2.5.2.3.p.4">Attributes are based on the usage within their different communities. Attributes can be extended on a regular basis and this reference document is updated accordingly.  </p>
<h1 id="rfc.section.2.5.2.4">
<a href="#rfc.section.2.5.2.4">2.5.2.4.</a> <a href="#category-1" id="category-1">category</a>
</h1>
<p id="rfc.section.2.5.2.4.p.1">category represents the intent of what the attribute is describing as selected by the attribute creator, using a list of pre-defined attribute categories.  </p>
<p id="rfc.section.2.5.2.4.p.2">category is represented as a JSON string. category MUST be present and it MUST be a valid selection for the chosen type. The list of valid category-type combinations is mentioned above.  </p>
<h1 id="rfc.section.2.5.2.5">
<a href="#rfc.section.2.5.2.5">2.5.2.5.</a> <a href="#toids-1" id="toids-1">to_ids</a>
</h1>
<p id="rfc.section.2.5.2.5.p.1">to_ids represents whether the Attribute to be created if the ShadowAttribute is accepted is meant to be actionable. Actionable defined attributes that can be used in automated processes as a pattern for detection in Local or Network Intrusion Detection System, log analysis tools or even filtering mechanisms.  </p>
<p id="rfc.section.2.5.2.5.p.2">to_ids is represented as a JSON boolean. to_ids MUST be present.  </p>
<h1 id="rfc.section.2.5.2.6">
<a href="#rfc.section.2.5.2.6">2.5.2.6.</a> <a href="#eventid-1" id="eventid-1">event_id</a>
</h1>
<p id="rfc.section.2.5.2.6.p.1">event_id represents a human-readable identifier referencing the Event object that the ShadowAttribute belongs to.  </p>
<p id="rfc.section.2.5.2.6.p.2">The event_id SHOULD be updated when the event is imported to reflect the newly created event's id on the instance.  </p>
<p id="rfc.section.2.5.2.6.p.3">event_id is represented as a JSON string. event_id MUST be present.  </p>
<h1 id="rfc.section.2.5.2.7">
<a href="#rfc.section.2.5.2.7">2.5.2.7.</a> <a href="#oldid" id="oldid">old_id</a>
</h1>
<p id="rfc.section.2.5.2.7.p.1">old_id represents a human-readable identifier referencing the Attribute object that the ShadowAttribute belongs to. A ShadowAttribute can this way target an existing Attribute, implying that it is a proposal to modify an existing Attribute, or alternatively it can be a proposal to create a new Attribute for the containing Event.  </p>
<p id="rfc.section.2.5.2.7.p.2">The old_id SHOULD be updated when the event is imported to reflect the newly created Attribute's id on the instance. Alternatively, if the ShadowAttribute proposes the creation of a new Attribute, it should be set to 0.  </p>
<p id="rfc.section.2.5.2.7.p.3">old_id is represented as a JSON string. old_id MUST be present.  </p>
<h1 id="rfc.section.2.5.2.8">
<a href="#rfc.section.2.5.2.8">2.5.2.8.</a> <a href="#timestamp-2" id="timestamp-2">timestamp</a>
</h1>
<p id="rfc.section.2.5.2.8.p.1">timestamp represents a reference time when the attribute was created or last modified. timestamp is expressed in seconds (decimal) since 1st of January 1970 (Unix timestamp). The time zone MUST be UTC.  </p>
<p id="rfc.section.2.5.2.8.p.2">timestamp is represented as a JSON string. timestamp MUST be present.  </p>
<h1 id="rfc.section.2.5.2.9">
<a href="#rfc.section.2.5.2.9">2.5.2.9.</a> <a href="#comment-1" id="comment-1">comment</a>
</h1>
<p id="rfc.section.2.5.2.9.p.1">comment is a contextual comment field.  </p>
<p id="rfc.section.2.5.2.9.p.2">comment is represented by a JSON string. comment MAY be present.  </p>
<h1 id="rfc.section.2.5.2.10">
<a href="#rfc.section.2.5.2.10">2.5.2.10.</a> <a href="#orgid-1" id="orgid-1">org_id</a>
</h1>
<p id="rfc.section.2.5.2.10.p.1">org_id represents a human-readable identifier referencing the proposal creator's Organisation object. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.5.2.10.p.2">Whilst attributes can only be created by the event creator organisation, shadow attributes can be created by third parties. org_id tracks the creator organisation.  </p>
<p id="rfc.section.2.5.2.10.p.3">org_id is represented by a JSON string and MUST be present.  </p>
<h1 id="rfc.section.2.5.2.11">
<a href="#rfc.section.2.5.2.11">2.5.2.11.</a> <a href="#proposaltodelete" id="proposaltodelete">proposal_to_delete</a>
</h1>
<p id="rfc.section.2.5.2.11.p.1">proposal_to_delete is a boolean flag that sets whether the shadow attribute proposes to alter an attribute, or whether it proposes to remove it completely.  </p>
<p id="rfc.section.2.5.2.11.p.2">Accepting a shadow attribute with this flag set will remove the target attribute.  </p>
<p id="rfc.section.2.5.2.11.p.3">proposal_to_delete is a JSON boolean and it MUST be present. If proposal_to_delete is set to true, old_id MUST NOT be 0.  </p>
<h1 id="rfc.section.2.5.2.12">
<a href="#rfc.section.2.5.2.12">2.5.2.12.</a> <a href="#deleted-1" id="deleted-1">deleted</a>
</h1>
<p id="rfc.section.2.5.2.12.p.1">deleted represents a setting that allows shadow attributes to be revoked. Revoked shadow attributes only serve to inform other instances that the shadow attribute is no longer active.  </p>
<p id="rfc.section.2.5.2.12.p.2">deleted is represented by a JSON boolean. deleted SHOULD be present.  </p>
<h1 id="rfc.section.2.5.2.13">
<a href="#rfc.section.2.5.2.13">2.5.2.13.</a> <a href="#data-1" id="data-1">data</a>
</h1>
<p id="rfc.section.2.5.2.13.p.1">data contains the base64 encoded contents of an attachment or a malware sample. For malware samples, the sample MUST be encrypted using a password protected zip archive, with the password being "infected".  </p>
<p id="rfc.section.2.5.2.13.p.2">data is represented by a JSON string in base64 encoding. data MUST be set for shadow attributes of type malware-sample and attachment.  </p>
<h1 id="rfc.section.2.5.2.14">
<a href="#rfc.section.2.5.2.14">2.5.2.14.</a> <a href="#firstseen-1" id="firstseen-1">first_seen</a>
</h1>
<p id="rfc.section.2.5.2.14.p.1">first_seen represents a reference time when the attribute was first seen. first_seen as an ISO 8601 datetime up to the micro-second with time zone support.  </p>
<p id="rfc.section.2.5.2.14.p.2">first_seen is represented as a JSON string. first_seen MAY be present.  </p>
<h1 id="rfc.section.2.5.2.15">
<a href="#rfc.section.2.5.2.15">2.5.2.15.</a> <a href="#lastseen-1" id="lastseen-1">last_seen</a>
</h1>
<p id="rfc.section.2.5.2.15.p.1">last_seen represents a reference time when the attribute was last seen. last_seen as an ISO 8601 datetime up to the micro-second with time zone support.  </p>
<p id="rfc.section.2.5.2.15.p.2">last_seen is represented as a JSON string. last_seen MAY be present.  </p>
<h1 id="rfc.section.2.5.3">
<a href="#rfc.section.2.5.3">2.5.3.</a> <a href="#org-1" id="org-1">Org</a>
</h1>
<p id="rfc.section.2.5.3.p.1">An Org object is composed of an uuid, name and id.  </p>
<p id="rfc.section.2.5.3.p.2">The uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the organization.  The organization UUID is globally assigned to an organization and SHALL be kept overtime.  </p>
<p id="rfc.section.2.5.3.p.3">The name is a readable description of the organization and SHOULD be present.  The id is a human-readable identifier generated by the instance and used as reference in the event.  A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.5.3.p.4">uuid, name and id are represented as a JSON string. uuid, name and id MUST be present.  </p>
<h1 id="rfc.section.2.5.3.1">
<a href="#rfc.section.2.5.3.1">2.5.3.1.</a> <a href="#sample-org-object-1" id="sample-org-object-1">Sample Org Object</a>
</h1>
<pre>
"Org": {
        "id": "2",
        "name": "CIRCL",
        "uuid": "55f6ea5e-2c60-40e5-964f-47a8950d210f"
       }
</pre>
<h1 id="rfc.section.2.5.3.2">
<a href="#rfc.section.2.5.3.2">2.5.3.2.</a> <a href="#value-1" id="value-1">value</a>
</h1>
<p id="rfc.section.2.5.3.2.p.1">value represents the payload of an attribute. The format of the value is dependent on the type of the attribute.  </p>
<p id="rfc.section.2.5.3.2.p.2">value is represented by a JSON string. value MUST be present.  </p>
<h1 id="rfc.section.2.6">
<a href="#rfc.section.2.6">2.6.</a> <a href="#object" id="object">Object</a>
</h1>
<p id="rfc.section.2.6.p.1">Objects serve as a contextual bond between a list of attributes within an event. Their main purpose is to describe more complex structures than can be described by a single attribute Each object is created using an Object Template and carries the meta-data of the template used for its creation within. Objects belong to a meta-category and are defined by a name.  </p>
<p id="rfc.section.2.6.p.2">The schema used is described by the template_uuid and template_version fields.  </p>
<p id="rfc.section.2.6.p.3">A MISP document containing an Object MUST contain a name, a meta-category, a description, a template_uuid and a template_version as described in the "Object Attributes" section.  </p>
<h1 id="rfc.section.2.6.1">
<a href="#rfc.section.2.6.1">2.6.1.</a> <a href="#sample-object" id="sample-object">Sample Object</a>
</h1>
<div id="rfc.figure.1"></div>
<div id="fig-sample-object"></div>
<pre>
"Object": {
   "id": "588",
   "name": "file",
   "meta-category": "file",
   "description": "File object describing a file with meta-information",
   "template_uuid": "688c46fb-5edb-40a3-8273-1af7923e2215",
   "template_version": "3",
   "event_id": "56",
   "uuid": "398b0094-0384-4c48-9bf0-22b3dff9c4d3",
   "timestamp": "1505747965",
   "distribution": "5",
   "sharing_group_id": "0",
   "comment": "",
   "deleted": false,
   "ObjectReference": [],
   "Attribute": [
     {
                 "id": "7822",
                 "type": "filename",
                 "category": "Payload delivery",
                 "to_ids": true,
                 "uuid": "59bfe3fb-bde0-4dfe-b5b1-2b10a07724d1",
                 "event_id": "56",
                 "distribution": "0",
                 "timestamp": "1505747963",
                 "comment": "",
                 "sharing_group_id": "0",
                 "deleted": false,
                 "disable_correlation": false,
                 "object_id": "588",
                 "object_relation": "filename",
                 "value": "StarCraft.exe",
                 "ShadowAttribute": [],
                 "first_seen": null,
                 "last_seen": null
     },
     "first_seen": "2019-06-02T22:14:28.711954+00:00",
     "last_seen": null
   ]
}
</pre>
<p class="figure">Figure 1</p>
<h1 id="rfc.section.2.6.2">
<a href="#rfc.section.2.6.2">2.6.2.</a> <a href="#object-attributes" id="object-attributes">Object Attributes</a>
</h1>
<h1 id="rfc.section.2.6.2.1">
<a href="#rfc.section.2.6.2.1">2.6.2.1.</a> <a href="#uuid-3" id="uuid-3">uuid</a>
</h1>
<p id="rfc.section.2.6.2.1.p.1">uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the object. The uuid MUST be preserved for any updates or transfer of the same object. UUID version 4 is RECOMMENDED when assigning it to a new object.  </p>
<h1 id="rfc.section.2.6.2.2">
<a href="#rfc.section.2.6.2.2">2.6.2.2.</a> <a href="#id-3" id="id-3">id</a>
</h1>
<p id="rfc.section.2.6.2.2.p.1">id represents the human-readable identifier associated to the object for a specific MISP instance. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.6.2.2.p.2">id is represented as a JSON string. id SHALL be present.  </p>
<h1 id="rfc.section.2.6.2.3">
<a href="#rfc.section.2.6.2.3">2.6.2.3.</a> <a href="#name" id="name">name</a>
</h1>
<p id="rfc.section.2.6.2.3.p.1">name represents the human-readable name of the object describing the intent of the object package.  </p>
<p id="rfc.section.2.6.2.3.p.2">name is represented as a JSON string. name MUST be present </p>
<h1 id="rfc.section.2.6.2.4">
<a href="#rfc.section.2.6.2.4">2.6.2.4.</a> <a href="#metacategory" id="metacategory">meta-category</a>
</h1>
<p id="rfc.section.2.6.2.4.p.1">meta-category represents the sub-category of objects that the given object belongs to. meta-categories are not tied to a fixed list of options but can be created on the fly.  </p>
<p id="rfc.section.2.6.2.4.p.2">meta-category is represented as a JSON string. meta-category MUST be present </p>
<h1 id="rfc.section.2.6.2.5">
<a href="#rfc.section.2.6.2.5">2.6.2.5.</a> <a href="#description" id="description">description</a>
</h1>
<p id="rfc.section.2.6.2.5.p.1">description is a human-readable description of the given object type, as derived from the template used for creation.  </p>
<p id="rfc.section.2.6.2.5.p.2">description is represented as a JSON string. id SHALL be present.  </p>
<h1 id="rfc.section.2.6.2.6">
<a href="#rfc.section.2.6.2.6">2.6.2.6.</a> <a href="#templateuuid" id="templateuuid">template_uuid</a>
</h1>
<p id="rfc.section.2.6.2.6.p.1">uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the template used to create the object. The uuid MUST be preserved to preserve the object's association with the correct template used for creation. UUID version 4 is RECOMMENDED when assigning it to a new object.  </p>
<h1 id="rfc.section.2.6.2.7">
<a href="#rfc.section.2.6.2.7">2.6.2.7.</a> <a href="#templateversion" id="templateversion">template_version</a>
</h1>
<p id="rfc.section.2.6.2.7.p.1">template_version represents a numeric incrementing version of the template used to create the object. It is used to associate the object to the correct version of the template and together with the template_uuid forms an association to the correct template type and version.  </p>
<p id="rfc.section.2.6.2.7.p.2">version is represented as a JSON string. version MUST be present.  </p>
<h1 id="rfc.section.2.6.2.8">
<a href="#rfc.section.2.6.2.8">2.6.2.8.</a> <a href="#eventid-2" id="eventid-2">event_id</a>
</h1>
<p id="rfc.section.2.6.2.8.p.1">event_id represents the human-readable identifier of the event that the object belongs to on a specific MISP instance. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.6.2.8.p.2">event_id is represented as a JSON string. event_id SHALL be present.  </p>
<h1 id="rfc.section.2.6.2.9">
<a href="#rfc.section.2.6.2.9">2.6.2.9.</a> <a href="#timestamp-3" id="timestamp-3">timestamp</a>
</h1>
<p id="rfc.section.2.6.2.9.p.1">timestamp represents a reference time when the object was created or last modified. timestamp is expressed in seconds (decimal) since 1st of January 1970 (Unix timestamp). The time zone MUST be UTC.  </p>
<p id="rfc.section.2.6.2.9.p.2">timestamp is represented as a JSON string. timestamp MUST be present.  </p>
<h1 id="rfc.section.2.6.2.10">
<a href="#rfc.section.2.6.2.10">2.6.2.10.</a> <a href="#distribution-2" id="distribution-2">distribution</a>
</h1>
<p id="rfc.section.2.6.2.10.p.1">distribution represents the basic distribution rules of the object. The system must adhere to the distribution setting for access control and for dissemination of the object.  </p>
<p id="rfc.section.2.6.2.10.p.2">distribution is represented by a JSON string. distribution MUST be present and be one of the following options: </p>
<p></p>

<dl>
<dt>0</dt>
<dd style="margin-left: 8">
<br> Your Organisation Only</dd>
<dt>1</dt>
<dd style="margin-left: 8">
<br> This Community Only</dd>
<dt>2</dt>
<dd style="margin-left: 8">
<br> Connected Communities</dd>
<dt>3</dt>
<dd style="margin-left: 8">
<br> All Communities</dd>
<dt>4</dt>
<dd style="margin-left: 8">
<br> Sharing Group</dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.6.2.11">
<a href="#rfc.section.2.6.2.11">2.6.2.11.</a> <a href="#sharinggroupid-2" id="sharinggroupid-2">sharing_group_id</a>
</h1>
<p id="rfc.section.2.6.2.11.p.1">sharing_group_id represents a human-readable identifier referencing a Sharing Group object that defines the distribution of the object, if distribution level "4" is set. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.6.2.11.p.2">sharing_group_id is represented by a JSON string and SHOULD be present. If a distribution level other than "4" is chosen the sharing_group_id MUST be set to "0".  </p>
<h1 id="rfc.section.2.6.2.12">
<a href="#rfc.section.2.6.2.12">2.6.2.12.</a> <a href="#comment-2" id="comment-2">comment</a>
</h1>
<p id="rfc.section.2.6.2.12.p.1">comment is a contextual comment field.  </p>
<p id="rfc.section.2.6.2.12.p.2">comment is represented by a JSON string. comment MAY be present.  </p>
<h1 id="rfc.section.2.6.2.13">
<a href="#rfc.section.2.6.2.13">2.6.2.13.</a> <a href="#deleted-2" id="deleted-2">deleted</a>
</h1>
<p id="rfc.section.2.6.2.13.p.1">deleted represents a setting that allows attributes to be revoked. Revoked attributes are not actionable and exist merely to inform other instances of a revocation.  </p>
<p id="rfc.section.2.6.2.13.p.2">deleted is represented by a JSON boolean. deleted MUST be present.  </p>
<h1 id="rfc.section.2.6.2.14">
<a href="#rfc.section.2.6.2.14">2.6.2.14.</a> <a href="#attribute-1" id="attribute-1">Attribute</a>
</h1>
<p id="rfc.section.2.6.2.14.p.1">Attribute is an array of attributes that describe the object with data.  </p>
<p id="rfc.section.2.6.2.14.p.2">Each attribute in an object MUST contain the parent event's ID in the event_id field and the parent object's ID in the object_id field.  </p>
<h1 id="rfc.section.2.6.2.15">
<a href="#rfc.section.2.6.2.15">2.6.2.15.</a> <a href="#firstseen-2" id="firstseen-2">first_seen</a>
</h1>
<p id="rfc.section.2.6.2.15.p.1">first_seen represents a reference time when the object was first seen. first_seen as an ISO 8601 datetime up to the micro-second with time zone support.  </p>
<p id="rfc.section.2.6.2.15.p.2">first_seen is represented as a JSON string. first_seen MAY be present.  </p>
<h1 id="rfc.section.2.6.2.16">
<a href="#rfc.section.2.6.2.16">2.6.2.16.</a> <a href="#lastseen-2" id="lastseen-2">last_seen</a>
</h1>
<p id="rfc.section.2.6.2.16.p.1">last_seen represents a reference time when the object was last seen. last_seen as an ISO 8601 datetime up to the micro-second with time zone support.  </p>
<p id="rfc.section.2.6.2.16.p.2">last_seen is represented as a JSON string. last_seen MAY be present.  </p>
<h1 id="rfc.section.2.7">
<a href="#rfc.section.2.7">2.7.</a> <a href="#object-references" id="object-references">Object References</a>
</h1>
<p id="rfc.section.2.7.p.1">Object References serve as a logical link between an Object and another referenced Object or Attribute. The relationship is categorised by an enumerated value from a fixed vocabulary.  </p>
<p id="rfc.section.2.7.p.2">The relationship_type is recommended to be taken from the MISP object relationship list [<a href="#MISP-R" class="xref">[MISP-R]</a>] is RECOMMENDED to ensure a coherent naming of the tags </p>
<p id="rfc.section.2.7.p.3">All Object References MUST contain an object_uuid, a referenced_uuid and a relationship type.  </p>
<h1 id="rfc.section.2.7.1">
<a href="#rfc.section.2.7.1">2.7.1.</a> <a href="#sample-objectreference-object" id="sample-objectreference-object">Sample ObjectReference object</a>
</h1>
<pre>
"ObjectReference": {
                    "id": "195",
                    "uuid": "59c21a2c-c0ac-4083-93b3-363da07724d1",
                    "timestamp": "1505892908",
                    "object_id": "591",
                    "event_id": "113",
                    "referenced_id": "590",
                    "referenced_type": "1",
                    "relationship_type": "derived-from",
                    "comment": "",
                    "deleted": false,
                    "object_uuid": "59c1134d-8a40-4c14-ad94-0f7ba07724d1",
                    "referenced_uuid": "59c1133c-9adc-4d06-a34b-0f7ca07724d1",
                   }
</pre>
<h1 id="rfc.section.2.7.2">
<a href="#rfc.section.2.7.2">2.7.2.</a> <a href="#objectreference-attributes" id="objectreference-attributes">ObjectReference Attributes</a>
</h1>
<h1 id="rfc.section.2.7.2.1">
<a href="#rfc.section.2.7.2.1">2.7.2.1.</a> <a href="#uuid-4" id="uuid-4">uuid</a>
</h1>
<p id="rfc.section.2.7.2.1.p.1">uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the object reference. The uuid MUST be preserved for any updates or transfer of the same object reference. UUID version 4 is RECOMMENDED when assigning it to a new object reference.  </p>
<h1 id="rfc.section.2.7.2.2">
<a href="#rfc.section.2.7.2.2">2.7.2.2.</a> <a href="#id-4" id="id-4">id</a>
</h1>
<p id="rfc.section.2.7.2.2.p.1">id represents the human-readable identifier associated to the object reference for a specific MISP instance.  </p>
<p id="rfc.section.2.7.2.2.p.2">id is represented as a JSON string. id SHALL be present.  </p>
<h1 id="rfc.section.2.7.2.3">
<a href="#rfc.section.2.7.2.3">2.7.2.3.</a> <a href="#timestamp-4" id="timestamp-4">timestamp</a>
</h1>
<p id="rfc.section.2.7.2.3.p.1">timestamp represents a reference time when the object was created or last modified. timestamp is expressed in seconds (decimal) since 1st of January 1970 (Unix timestamp). The time zone MUST be UTC.  </p>
<p id="rfc.section.2.7.2.3.p.2">timestamp is represented as a JSON string. timestamp MUST be present.  </p>
<h1 id="rfc.section.2.7.2.4">
<a href="#rfc.section.2.7.2.4">2.7.2.4.</a> <a href="#objectid" id="objectid">object_id</a>
</h1>
<p id="rfc.section.2.7.2.4.p.1">object_id represents the human-readable identifier of the object that the object reference belongs to on a specific MISP instance. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.7.2.4.p.2">event_id is represented as a JSON string. event_id SHALL be present.  </p>
<h1 id="rfc.section.2.7.2.5">
<a href="#rfc.section.2.7.2.5">2.7.2.5.</a> <a href="#eventid-3" id="eventid-3">event_id</a>
</h1>
<p id="rfc.section.2.7.2.5.p.1">event_id represents the human-readable identifier of the event that the object reference belongs to on a specific MISP instance. A human-readable identifier MUST be represented as an unsigned integer.  </p>
<p id="rfc.section.2.7.2.5.p.2">event_id is represented as a JSON string. event_id SHALL be present.  </p>
<h1 id="rfc.section.2.7.2.6">
<a href="#rfc.section.2.7.2.6">2.7.2.6.</a> <a href="#referencedid" id="referencedid">referenced_id</a>
</h1>
<p id="rfc.section.2.7.2.6.p.1">referenced_id represents the human-readable identifier of the object or attribute that the parent object  of the object reference points to on a specific MISP instance.  </p>
<p id="rfc.section.2.7.2.6.p.2">referenced_id is represented as a JSON string. referenced_id MAY be present.  </p>
<h1 id="rfc.section.2.7.2.7">
<a href="#rfc.section.2.7.2.7">2.7.2.7.</a> <a href="#referencedtype" id="referencedtype">referenced_type</a>
</h1>
<p id="rfc.section.2.7.2.7.p.1">referenced_type represents the numeric value describing what the object reference points to, "0" representing an attribute and "1" representing an object </p>
<p id="rfc.section.2.7.2.7.p.2">referenced_type is represented as a JSON string. referenced_type MAY be present.  </p>
<h1 id="rfc.section.2.7.2.8">
<a href="#rfc.section.2.7.2.8">2.7.2.8.</a> <a href="#relationshiptype" id="relationshiptype">relationship_type</a>
</h1>
<p id="rfc.section.2.7.2.8.p.1">relationship_type represents the human-readable context of the relationship between an object and another object or attribute as described by the object_reference.  </p>
<p id="rfc.section.2.7.2.8.p.2">referenced_type is represented as a JSON string. relationship_type MUST be present.  </p>
<h1 id="rfc.section.2.7.2.9">
<a href="#rfc.section.2.7.2.9">2.7.2.9.</a> <a href="#comment-3" id="comment-3">comment</a>
</h1>
<p id="rfc.section.2.7.2.9.p.1">comment is a contextual comment field.  </p>
<p id="rfc.section.2.7.2.9.p.2">comment is represented by a JSON string. comment MAY be present.  </p>
<h1 id="rfc.section.2.7.2.10">
<a href="#rfc.section.2.7.2.10">2.7.2.10.</a> <a href="#deleted-3" id="deleted-3">deleted</a>
</h1>
<p id="rfc.section.2.7.2.10.p.1">deleted represents a setting that allows object references to be revoked. Revoked object references are not actionable and exist merely to inform other instances of a revocation.  </p>
<p id="rfc.section.2.7.2.10.p.2">deleted is represented by a JSON boolean. deleted MUST be present.  </p>
<h1 id="rfc.section.2.7.2.11">
<a href="#rfc.section.2.7.2.11">2.7.2.11.</a> <a href="#objectuuid" id="objectuuid">object_uuid</a>
</h1>
<p id="rfc.section.2.7.2.11.p.1">object_uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the object that the given object reference belongs to. The object_uuid MUST be preserved to preserve the object reference's association with the object.  </p>
<h1 id="rfc.section.2.7.2.12">
<a href="#rfc.section.2.7.2.12">2.7.2.12.</a> <a href="#referenceduuid" id="referenceduuid">referenced_uuid</a>
</h1>
<p id="rfc.section.2.7.2.12.p.1">referenced_uuid represents the Universally Unique IDentifier (UUID) <a href="#RFC4122" class="xref">[RFC4122]</a> of the object or attribute that is being referenced by the object reference. The referenced_uuid MUST be preserved to preserve the object reference's association with the object or attribute.  </p>
<h1 id="rfc.section.2.8">
<a href="#rfc.section.2.8">2.8.</a> <a href="#tag" id="tag">Tag</a>
</h1>
<p id="rfc.section.2.8.p.1">A tag is a simple method to classify an event with a simple string. The tag name can be freely chosen. The tag name can be also chosen from a fixed machine-tag vocabulary called MISP taxonomies[<a href="#MISP-T" class="xref">[MISP-T]</a>]. When an event is distributed outside an organisation, the use of MISP taxonomies[<a href="#MISP-T" class="xref">[MISP-T]</a>] is RECOMMENDED to ensure a coherent naming of the tags. A tag is represented as a JSON array where each element describes each tag associated. A tag array SHALL be at event level or attribute level. A tag element is described with a name, id, colour and exportable flag.  </p>
<p id="rfc.section.2.8.p.2">exportable represents a setting if the tag is kept local or exportable to other MISP instances. exportable is represented by a JSON boolean. id is a human-readable identifier that references the tag on the local instance. colour represents an RGB value of the tag.  </p>
<p id="rfc.section.2.8.p.3">name MUST be present. colour, id and exportable SHALL be present.  </p>
<h1 id="rfc.section.2.8.1">
<a href="#rfc.section.2.8.1">2.8.1.</a> <a href="#sample-tag" id="sample-tag">Sample Tag</a>
</h1>
<pre>
"Tag": [{
        "exportable": true,
        "colour": "#ffffff",
        "name": "tlp:white",
        "id": "2" }]
</pre>
<h1 id="rfc.section.2.9">
<a href="#rfc.section.2.9">2.9.</a> <a href="#sighting" id="sighting">Sighting</a>
</h1>
<p id="rfc.section.2.9.p.1">A sighting is an ascertainment which describes whether an attribute has been seen under a given set of conditions. The sighting can include the organisation who sighted the attribute or can be anonymised. Sighting is composed of a JSON array in which each element describes one singular instance of a sighting. A sighting element is a JSON object composed of the following values: </p>
<p id="rfc.section.2.9.p.2">type MUST be present. type describes the type of a sighting. MISP allows 3 default types: </p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="center">Sighting type</th>
<th class="center">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="center">0</td>
<td class="center">denotes an attribute which has been seen</td>
</tr>
<tr>
<td class="center">1</td>
<td class="center">denotes an attribute which has been seen and confirmed as false-positive</td>
</tr>
<tr>
<td class="center">2</td>
<td class="center">denotes an attribute which will be expired at the time of the sighting</td>
</tr>
</tbody>
</table>
<p id="rfc.section.2.9.p.3">uuid MUST be present. uuid references the uuid of the sighted attribute.  </p>
<p id="rfc.section.2.9.p.4">date_sighting MUST be present. date_sighting is expressed in seconds (decimal) elapsed since 1st of January 1970 (Unix timestamp). date_sighting represents when the referenced attribute, designated by its uuid, is sighted.  </p>
<p id="rfc.section.2.9.p.5">source MAY be present. source is represented as a JSON string and represents the human-readable version of the sighting source, which can be a given piece of software (e.g. SIEM), device or a specific analytical process.  </p>
<p id="rfc.section.2.9.p.6">id, event_id and attribute_id MAY be present.  </p>
<p id="rfc.section.2.9.p.7">id represents the human-readable identifier of the sighting reference which belongs to a specific MISP instance.  event_id represents the human-readable identifier of the event referenced by the sighting and belongs to a specific MISP instance.  attribute_id represents the human-readable identifier of the attribute referenced by the sighting and belongs to a specific MISP instance.  </p>
<p id="rfc.section.2.9.p.8">org_id MAY be present along the JSON object describing the organisation. If the org_id is not present, the sighting is considered as anonymised.  </p>
<p id="rfc.section.2.9.p.9">org_id represents the human-readable identifier of the organisation which did the sighting and belongs to a specific MISP instance.  </p>
<p id="rfc.section.2.9.p.10">A human-readable identifier MUST be represented as an unsigned integer.  </p>
<h1 id="rfc.section.2.9.1">
<a href="#rfc.section.2.9.1">2.9.1.</a> <a href="#sample-sighting" id="sample-sighting">Sample Sighting</a>
</h1>
<pre>
"Sighting": [
		   {
				"id": "13599",
				"attribute_id": "1201615",
				"event_id": "10164",
				"org_id": "2",
				"date_sighting": "1517581400",
				"uuid": "5a747459-41b4-4826-9b29-42dd950d210f",
				"source": "M2M-CIRCL",
				"type": "0",
				"Organisation": {
					"id": "2",
					"uuid": "55f6ea5e-2c60-40e5-964f-47a8950d210f",
					"name": "CIRCL"
				}
			},
			{
				"id": "13601",
				"attribute_id": "1201615",
				"event_id": "10164",
				"org_id": "2",
				"date_sighting": "1517581401",
				"uuid": "5a74745a-a190-4d04-b719-4916950d210f",
				"source": "M2M-CIRCL",
				"type": "0",
				"Organisation": {
					"id": "2",
					"uuid": "55f6ea5e-2c60-40e5-964f-47a8950d210f",
					"name": "CIRCL"
				}
			}
		]
</pre>
<h1 id="rfc.section.2.10">
<a href="#rfc.section.2.10">2.10.</a> <a href="#galaxy" id="galaxy">Galaxy</a>
</h1>
<p id="rfc.section.2.10.p.1">A galaxy is a simple method to express a large object called cluster that can be attached to MISP events. A cluster can be composed of one or more elements. Elements are expressed as key-values.  </p>
<h1 id="rfc.section.2.10.1">
<a href="#rfc.section.2.10.1">2.10.1.</a> <a href="#sample-galaxy" id="sample-galaxy">Sample Galaxy</a>
</h1>
<pre>
"Galaxy": [ {
           "id": "18",
           "uuid": "698774c7-8022-42c4-917f-8d6e4f06ada3",
           "name": "Threat Actor",
           "type": "threat-actor",
           "description": "Threat actors are characteristics of malicious actors
                          (or adversaries) representing a cyber attack threat
                          including presumed intent and historically observed behaviour.",
                "version": "1",
        "GalaxyCluster": [
            {
                "id": "1699",
                "uuid": "7cdff317-a673-4474-84ec-4f1754947823",
                "type": "threat-actor",
                "value": "Anunak",
                "tag_name": "misp-galaxy:threat-actor=\"Anunak\"",
                "description": "Groups targeting financial organizations
                    or people with significant financial assets.",
                "galaxy_id": "18",
                "source": "MISP Project",
                "authors": [
                    "Alexandre Dulaunoy",
                    "Florian Roth",
                    "Thomas Schreck",
                    "Timo Steffens",
                    "Various"
                ],
                "tag_id": "111",
                        "meta": {
                            "synonyms": [
                                "Carbanak",
                                "Carbon Spider"
                            ],
                            "country": [
                                "RU"
                            ],
                            "motive": [
                                "Cybercrime"
                            ]
                        }
                    }
                ]
            }
        ]
</pre>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#json-schema" id="json-schema">JSON Schema</a>
</h1>
<p id="rfc.section.3.p.1">The JSON Schema <a href="#JSON-SCHEMA" class="xref">[JSON-SCHEMA]</a> below defines the structure of the MISP core format as literally described before. The JSON Schema is used to validate MISP events at creation time or parsing.  </p>
<pre>
{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Validator for misp events",
  "id": "https://github.com/MISP/MISP/blob/2.4/format/2.4/schema.json",
  "defs": {
    "org": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "uuid": {
          "type": "string"
        }
      },
      "required": [
        "uuid"
      ]
    },
    "orgc": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "uuid": {
          "type": "string"
        }
      },
      "required": [
        "uuid"
      ]
    },
    "sharing_group": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "releasability": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "uuid": {
          "type": "string"
        },
        "organisation_uuid": {
          "type": "string"
        },
        "org_id": {
          "type": "string"
        },
        "sync_user_id": {
          "type": "string"
        },
        "active": {
          "type": "boolean"
        },
        "created": {
          "type": "string"
        },
        "modified": {
          "type": "string"
        },
        "local": {
          "type": "boolean"
        },
        "roaming": {
          "type": "boolean"
        },
        "Organisation": {
          "$ref": "#/defs/org"
        },
        "SharingGroupOrg": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/sharing_group_org"
          }
        },
        "SharingGroupServer": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/sharing_group_server"
          }
        },
        "required": [
          "uuid"
        ]
      },
      "required": [
        "uuid"
      ]
    },
    "sharing_group_org": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "sharing_group_id": {
          "type": "string"
        },
        "org_id": {
          "type": "string"
        },
        "extend": {
          "type": "boolean"
        },
        "Organisation": {
          "$ref": "#/defs/org"
        }
      }
    },
    "sharing_group_server": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "sharing_group_id": {
          "type": "string"
        },
        "server_id": {
          "type": "string"
        },
        "all_orgs": {
          "type": "boolean"
        },
        "Server": {
          "$ref": "#/defs/server"
        }
      }
    },
    "server": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "url": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      }
    },
    "object": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "uuid": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "event_id": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "template_uuid": {
          "type": "string"
        },
        "template_version": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "meta-category": {
          "type": "string"
        },
        "deleted": {
          "type": "boolean"
        },
        "timestamp": {
          "type": "string"
        },
        "first_seen": {
          "type": "string"
        },
        "last_seen": {
          "type": "string"
        },
        "distribution": {
          "type": "string"
        },
        "sharing_group_id": {
          "type": "string"
        },
        "comment": {
          "type": "string"
        },
        "ObjectReference": {
            "type": "array",
            "uniqueItems": true,
            "items": {
              "$ref": "#/defs/objectreference"
            }
        },
        "Attribute": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/attribute"
          }
        }
      }
    },
    "sighthing": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "attribute_id": {
          "type": "string"
        },
        "event_id": {
          "type": "string"
        },
        "source": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "org_id": {
          "type": "string"
        },
        "date_sighting": {
          "type": "string"
        },
        "uuid": {
          "type": "string"
        },
        "Organisation": {
            "$ref": "#/defs/organisation"
        }
      }
    },
    "organisation": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "uuid": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      }
    },
    "objectreference": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "deleted": {
          "type": "boolean"
        },
        "object_id": {
          "type": "string"
        },
        "event_id": {
          "type": "string"
        },
        "timestamp": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "uuid": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "referenced_id": {
          "type": "string"
        },
        "referenced_uuid": {
          "type": "string"
        },
        "referenced_type": {
          "type": "string"
        },
        "relationship_type": {
          "type": "string"
        },
        "object_uuid": {
          "type": "string"
        },
        "comment": {
          "type": "string"
        },
        "Object": {
          "$ref": "#/defs/object"
        }
      }
    },
    "attribute": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "old_id": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "category": {
          "type": "string"
        },
        "to_ids": {
          "type": "boolean"
        },
        "uuid": {
          "type": "string"
        },
        "event_id": {
          "type": "string"
        },
        "event_uuid": {
          "type": "string"
        },
        "proposal_to_delete": {
          "type": "boolean"
        },
        "validationIssue": {
          "type": "boolean"
        },
        "Org": {
          "$ref": "#/defs/organisation"
        },
        "org_id": {
          "type": "string"
        },
        "distribution": {
          "type": "string"
        },
        "timestamp": {
          "type": "string"
        },
        "first_seen": {
          "type": "string"
        },
        "last_seen": {
          "type": "string"
        },
        "comment": {
          "type": "string"
        },
        "sharing_group_id": {
          "type": "string"
        },
        "deleted": {
          "type": "boolean"
        },
        "disable_correlation": {
          "type": "boolean"
        },
        "value": {
          "type": "string"
        },
        "data": {
          "type": "string"
        },
        "object_relation": {
          "type": ["string", "null"]
        },
        "object_id": {
          "type": "string"
        },
        "SharingGroup": {
          "$ref": "#/defs/sharing_group"
        },
        "ShadowAttribute": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/attribute"
          }
        },
        "Sighting": {
            "type": "array",
            "uniqueItems": true,
            "items": {
              "$ref": "#/defs/sighthing"
            }
        },
        "Galaxy": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/galaxy"
          }
        },
        "Tag": {
          "uniqueItems": true,
          "type": "array",
          "items": {
            "$ref": "#/defs/tag"
          }
        }
      }
    },
    "event": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "orgc_id": {
          "type": "string"
        },
        "org_id": {
          "type": "string"
        },
        "date": {
          "type": "string"
        },
        "extends_uuid": {
            "type": "string"
        },
        "threat_level_id": {
          "type": "string"
        },
        "info": {
          "type": "string"
        },
        "published": {
          "type": "boolean"
        },
        "uuid": {
          "type": "string"
        },
        "attribute_count": {
          "type": "string"
        },
        "analysis": {
          "type": "string"
        },
        "timestamp": {
          "type": "string"
        },
        "distribution": {
          "type": "string"
        },
        "proposal_email_lock": {
          "type": "boolean"
        },
        "locked": {
          "type": "boolean"
        },
        "publish_timestamp": {
          "type": "string"
        },
        "sharing_group_id": {
          "type": "string"
        },
        "disable_correlation": {
          "type": "boolean"
        },
        "event_creator_email": {
          "type": "string"
        },
        "Org": {
          "$ref": "#/defs/org"
        },
        "Orgc": {
          "$ref": "#/defs/org"
        },
        "SharingGroup": {
          "$ref": "#/defs/sharing_group"
        },
        "Attribute": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/attribute"
          }
        },
        "ShadowAttribute": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/attribute"
          }
        },
        "RelatedEvent": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Event":{
                  "$ref": "#/defs/event"
                }
            }
          }
        },
        "Galaxy": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/galaxy"
          }
        },
        "Object": {
            "type": "array",
            "uniqueItems": true,
            "items": {
                "$ref": "#/defs/object"
            }
        },
        "Tag": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/tag"
          }
        }
      }
    },
    "tag": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "colour": {
          "type": "string"
        },
        "exportable": {
          "type": "boolean"
        },
        "hide_tag": {
          "type": "boolean"
        },
        "user_id": {
          "type": "string"
        }
      }
    },
    "galaxy": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "uuid": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "icon": {
          "type": "string"
        },
        "namespace": {
          "type": "string"
        },
        "GalaxyCluster": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/defs/galaxy_cluster"
          }
        }
      }
    },
    "galaxy_cluster": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "uuid": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "value": {
          "type": "string"
        },
        "tag_name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "galaxy_id": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "source": {
          "type": "string"
        },
        "authors": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "type": "string"
          }
        },
        "tag_id": {
          "type": "string"
        },
        "meta": {
          "type": "object"
        }
      }
    }
  },
  "type": "object",
  "properties": {
    "Event": {
      "$ref": "#/defs/event"
    }
  },
  "required": [
    "Event"
  ]
}
</pre>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#manifest" id="manifest">Manifest</a>
</h1>
<p id="rfc.section.4.p.1">MISP events can be shared over an HTTP repository, a file package or USB key. A manifest file is used to provide an index of MISP events allowing to only fetch the recently updated files without the need to parse each json file.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#format-1" id="format-1">Format</a>
</h1>
<p id="rfc.section.4.1.p.1">A manifest file is a simple JSON file named manifest.json in a directory where the MISP events are located.  Each MISP event is a file located in the same directory with the event uuid as filename with the json extension.  </p>
<p id="rfc.section.4.1.p.2">The manifest format is a JSON object composed of a dictionary where the field is the uuid of the event.  </p>
<p id="rfc.section.4.1.p.3">Each uuid is composed of a JSON object with the following fields which came from the original event referenced by the same uuid: </p>
<p></p>

<ul>
<li>info (MUST)</li>
<li>Orgc object (MUST)</li>
<li>analysis (SHALL)</li>
<li>timestamp (MUST)</li>
<li>date (MUST)</li>
<li>threat_level_id (SHALL)</li>
</ul>

<p> </p>
<p id="rfc.section.4.1.p.5">In addition to the fields originating from the event, the following fields can be added: </p>
<p></p>

<ul>
<li>integrity:sha256 represents the SHA256 value in hexadecimal representation of the associated MISP event file to ensure integrity of the file. (SHOULD)</li>
<li>integrity:pgp represents a detached PGP signature <a href="#RFC4880" class="xref">[RFC4880]</a> of the associated MISP event file to ensure integrity of the file. (SHOULD)</li>
</ul>

<p> </p>
<p id="rfc.section.4.1.p.7">If a detached PGP signature is used for each MISP event, a detached PGP signature is a MUST to ensure integrity of the manifest file.  A detached PGP signature for a manifest file is a manifest.json.asc file containing the PGP signature.  </p>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#sample-manifest" id="sample-manifest">Sample Manifest</a>
</h1>
<pre>
{
  "57c6ac4c-c60c-4f79-a38f-b666950d210f": {
    "info": "Malspam 2016-08-31 (.wsf in .zip) - campaign: Photo",
    "Orgc": {
      "id": "2",
      "name": "CIRCL",
      "uuid": "55f6ea5e-2c60-40e5-964f-47a8950d210f"
    },
    "analysis": "0",
    "Tag": [
      {
        "colour": "#3d7a00",
        "name": "circl:incident-classification=\"malware\""
      },
      {
        "colour": "#ffffff",
        "name": "tlp:white"
      }
    ],
    "timestamp": "1472638251",
    "date": "2016-08-31",
    "threat_level_id": "3"
  },
  "5720accd-dd28-45f8-80e5-4605950d210f": {
    "info": "Malspam 2016-04-27 - Locky",
    "Orgc": {
      "id": "2",
      "name": "CIRCL"
    },
    "analysis": "2",
    "Tag": [
      {
        "colour": "#ffffff",
        "name": "tlp:white"
      },
      {
        "colour": "#3d7a00",
        "name": "circl:incident-classification=\"malware\""
      },
      {
        "colour": "#2c4f00",
        "name": "malware_classification:malware-category=\"Ransomware\""
      }
    ],
    "timestamp": "1461764231",
    "date": "2016-04-27",
    "threat_level_id": "3"
  }
}
</pre>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#implementation" id="implementation">Implementation</a>
</h1>
<p id="rfc.section.5.p.1">MISP format is implemented by different software including the MISP threat sharing platform and libraries like PyMISP <a href="#MISP-P" class="xref">[MISP-P]</a>. Implementations use the format as an export/import mechanism, staging transport format or synchronisation format as used in the MISP core platform. MISP format doesn't impose any restriction on the data representation of the format in data-structure of other implementations.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">MISP events might contain sensitive or confidential information. Adequate access control and encryption measures shall be implemented to ensure the confidentiality of the MISP events.  </p>
<p id="rfc.section.6.p.2">Adversaries might include malicious content in MISP events and attributes.  Implementation MUST consider the input of malicious inputs beside the standard threat information that might already include malicious intended inputs.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.7.p.1">The authors wish to thank all the MISP community who are supporting the creation of open standards in threat intelligence sharing. A special thank to Nicolas Bareil for the review of the JSON Schema.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#references" id="references">References</a>
</h1>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4122">[RFC4122]</b></td>
<td class="top">
<a>Leach, P.</a>, <a>Mealling, M.</a> and <a>R. Salz</a>, "<a href="https://tools.ietf.org/html/rfc4122">A Universally Unique IDentifier (UUID) URN Namespace</a>", RFC 4122, DOI 10.17487/RFC4122, July 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4880">[RFC4880]</b></td>
<td class="top">
<a>Callas, J.</a>, <a>Donnerhacke, L.</a>, <a>Finney, H.</a>, <a>Shaw, D.</a> and <a>R. Thayer</a>, "<a href="https://tools.ietf.org/html/rfc4880">OpenPGP Message Format</a>", RFC 4880, DOI 10.17487/RFC4880, November 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8259">[RFC8259]</b></td>
<td class="top">
<a>Bray, T.</a>, "<a href="https://tools.ietf.org/html/rfc8259">The JavaScript Object Notation (JSON) Data Interchange Format</a>", STD 90, RFC 8259, DOI 10.17487/RFC8259, December 2017.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="JSON-SCHEMA">[JSON-SCHEMA]</b></td>
<td class="top">
<a></a>, "<a href="https://tools.ietf.org/html/draft-wright-json-schema">JSON Schema: A Media Type for Describing JSON Documents</a>", 2016.</td>
</tr>
<tr>
<td class="reference"><b id="MISP-P">[MISP-P]</b></td>
<td class="top">
<a>MISP</a>, "<a href="https://github.com/MISP">MISP Project - Open Source Threat Intelligence Platform and Open Standards For Threat Information Sharing</a>"</td>
</tr>
<tr>
<td class="reference"><b id="MISP-R">[MISP-R]</b></td>
<td class="top">
<a>MISP</a>, "<a href="https://github.com/MISP/misp-objects/tree/master/relationships">MISP Object Relationship Types - common vocabulary of relationships</a>"</td>
</tr>
<tr>
<td class="reference"><b id="MISP-T">[MISP-T]</b></td>
<td class="top">
<a>MISP</a>, "<a href="https://github.com/MISP/misp-taxonomies">MISP Taxonomies - shared and common vocabularies of tags</a>"</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Alexandre Dulaunoy</span> 
	  <span class="n hidden">
		<span class="family-name">Dulaunoy</span>
	  </span>
	</span>
	<span class="org vcardline">Computer Incident Response Center Luxembourg</span>
	<span class="adr">
	  <span class="vcardline">16, bd d'Avranches</span>

	  <span class="vcardline">
		<span class="locality">Luxembourg</span>,  
		<span class="region"></span>
		<span class="code">L-1160</span>
	  </span>
	  <span class="country-name vcardline">Luxembourg</span>
	</span>
	<span class="vcardline">Phone: +352 247 88444</span>

<span class="vcardline">EMail: <a href="mailto:alexandre.dulaunoy@circl.lu">alexandre.dulaunoy@circl.lu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Andras Iklody</span> 
	  <span class="n hidden">
		<span class="family-name">Iklody</span>
	  </span>
	</span>
	<span class="org vcardline">Computer Incident Response Center Luxembourg</span>
	<span class="adr">
	  <span class="vcardline">16, bd d'Avranches</span>

	  <span class="vcardline">
		<span class="locality">Luxembourg</span>,  
		<span class="region"></span>
		<span class="code">L-1160</span>
	  </span>
	  <span class="country-name vcardline">Luxembourg</span>
	</span>
	<span class="vcardline">Phone: +352 247 88444</span>

<span class="vcardline">EMail: <a href="mailto:andras.iklody@circl.lu">andras.iklody@circl.lu</a></span>

  </address>
</div>

</body>
</html>
